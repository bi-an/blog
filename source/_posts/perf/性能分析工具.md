---
title: æ€§èƒ½åˆ†æå·¥å…·
date: 2025-11-26 10:12:33
categories:
tags:
---

## æ€§èƒ½åˆ†æå·¥å…·

| å·¥å…·                             |                   ç±»å‹/å®šä½                    | attach æ”¯æŒ |                    åˆ†æèŒƒå›´                     |                             ç‰¹ç‚¹                              |               ä¸ perf çš„å…³ç³»               |                å¼€æº/å•†ä¸šæˆæƒ                 |            é€‚ç”¨äººç¾¤             |
| -------------------------------- | :--------------------------------------------: | :---------: | :---------------------------------------------: | :-----------------------------------------------------------: | :----------------------------------------: | :------------------------------------------: | :-----------------------------: |
| Oracle Performance Analyzer (PA) | ä¼ä¸šçº§æ€§èƒ½åˆ†æå™¨ï¼ŒOracle Developer Studio å¥—ä»¶ |     âœ…      | ç”¨æˆ·æ€ç¨‹åº (C/C++/Java/Fortran/Scala)ï¼Œå¹¶è¡Œåº”ç”¨ |         GUI ä¸°å¯Œï¼Œä½å¼€é”€é‡‡æ ·ï¼Œå‡½æ•°/æºä»£ç /æŒ‡ä»¤çº§åˆ†æ          |                  ç‹¬ç«‹å·¥å…·                  |      å•†ä¸šè½¯ä»¶ (Oracle Developer Studio)      |   ä¼ä¸š/ç§‘ç ”ç¯å¢ƒä¸‹çš„åº”ç”¨å¼€å‘è€…   |
| perf                             |           Linux å†…æ ¸è‡ªå¸¦æ€§èƒ½åˆ†ææ¡†æ¶           |     âœ…      |           ç”¨æˆ·æ€ + å†…æ ¸æ€ + ç¡¬ä»¶äº‹ä»¶            | åŠŸèƒ½å…¨é¢ï¼Œæ”¯æŒè°ƒç”¨é“¾ã€ç¡¬ä»¶è®¡æ•°å™¨ï¼Œç”Ÿæ€ä¸°å¯Œ (eBPF, flamegraph) |                  åŸºç¡€æ¡†æ¶                  |          å¼€æº (GPLï¼ŒLinux å†…æ ¸è‡ªå¸¦)          |    ç³»ç»Ÿå·¥ç¨‹å¸ˆï¼Œåº•å±‚æ€§èƒ½è°ƒä¼˜     |
| gprofng                          |            GNU æ–°ä¸€ä»£åº”ç”¨æ€§èƒ½åˆ†æå™¨            |     âœ…      |      ç”¨æˆ·æ€ç¨‹åº (C/C++/Java/Scala)ï¼Œè·¨å¹³å°      |      åŸºäºå®éªŒç›®å½•ï¼Œæ”¯æŒ GUIï¼Œè·¨è¯­è¨€ï¼Œç»§æ‰¿ Oracle PA æ€è·¯      |                  ç‹¬ç«‹å·¥å…·                  |              å¼€æº (GNU å·¥å…·é“¾)               |   åº”ç”¨å¼€å‘è€…ï¼Œè·¨å¹³å°æ€§èƒ½ä¼˜åŒ–    |
| gprof                            |          ç»å…¸ GNU æ€§èƒ½åˆ†æå™¨ (1980s)           |     âŒ      |               ç”¨æˆ·æ€ç¨‹åº (C/C++)                |  éœ€ç¼–è¯‘æ—¶ -pgï¼Œç”Ÿæˆ gmon.outï¼ŒåŠŸèƒ½æœ‰é™ï¼Œä¸æ”¯æŒå¤šçº¿ç¨‹/attach   |                  ç‹¬ç«‹å·¥å…·                  |              å¼€æº (GNU å·¥å…·é“¾)               |  å­¦æœ¯/æ•™å­¦åœºæ™¯ï¼Œç®€å•å‡½æ•°çº§åˆ†æ  |
| Intel PMU Tools                  |        Intel æä¾›çš„ç¡¬ä»¶æ€§èƒ½è®¡æ•°å™¨å·¥å…·é›†        |     âœ…      | ç¡¬ä»¶äº‹ä»¶ (CPU pipelineã€cacheã€branchã€memory)  |         åŸºäº PMUï¼Œæä¾› top-down åˆ†æï¼Œè§£é‡Šå¾®æ¶æ„ç“¶é¢ˆ          | ä¾èµ– perf æ”¶é›†æ•°æ®ï¼Œå±äº perf çš„å¢å¼ºè§£é‡Šå±‚ |  å¼€æº (MIT/Apache è®¸å¯ï¼ŒIntel GitHub æä¾›)   |   ç³»ç»Ÿ/æ€§èƒ½å·¥ç¨‹å¸ˆï¼Œç¡¬ä»¶çº§è°ƒä¼˜   |
| Intel Advisor                    |      é«˜çº§æ€§èƒ½ä¼˜åŒ–å·¥å…· (Intel oneAPI å¥—ä»¶)      |     âœ…      |           ç”¨æˆ·æ€ç¨‹åºï¼Œå°¤å…¶æ˜¯ HPC åº”ç”¨           |      æä¾›çŸ¢é‡åŒ–åˆ†æã€å†…å­˜è®¿é—®ä¼˜åŒ–ã€å¹¶è¡ŒåŒ–å»ºè®®ï¼ŒGUI æ”¯æŒ       |                  ç‹¬ç«‹å·¥å…·                  |   å•†ä¸šè½¯ä»¶ (Intel oneAPI å¥—ä»¶ï¼Œéƒ¨åˆ†å…è´¹ç‰ˆ)   |    HPC å¼€å‘è€…ï¼Œç§‘å­¦è®¡ç®—ä¼˜åŒ–     |
| Intel VTune Profiler             |                 æ·±åº¦æ€§èƒ½åˆ†æå™¨                 |     âœ…      |      CPU/GPU/FPGAã€å†…å­˜ã€çº¿ç¨‹ã€I/Oã€å¾®æ¶æ„      |    å¾®æ¶æ„çº§å‰–æï¼Œæ”¯æŒ cacheã€pipelineã€åˆ†æ”¯é¢„æµ‹ï¼ŒåŠŸèƒ½å…¨é¢     |        ç‹¬ç«‹å·¥å…·ï¼Œä½†å¯ç»“åˆ perf æ•°æ®        | å•†ä¸šè½¯ä»¶ (Intel oneAPI å¥—ä»¶ï¼Œæä¾›å…è´¹ç¤¾åŒºç‰ˆ) | ç³»ç»Ÿ/æ€§èƒ½å·¥ç¨‹å¸ˆï¼Œç¡¬ä»¶ä¸åº”ç”¨ä¼˜åŒ– |
| Linaro MAP (Arm Forge MAP)       |             HPC å¹¶è¡Œåº”ç”¨æ€§èƒ½åˆ†æå™¨             |     âœ…      |        MPIã€OpenMPã€UPC ç­‰å¤§è§„æ¨¡å¹¶è¡Œåº”ç”¨        |  ä½å¼€é”€é‡‡æ ·ï¼Œè·¨èŠ‚ç‚¹æ•´ä½“åˆ†æï¼Œæºä»£ç è¡Œçº§è€—æ—¶å±•ç¤ºï¼ŒGUI å¯è§†åŒ–   |                  ç‹¬ç«‹å·¥å…·                  |     å•†ä¸šè½¯ä»¶ (Arm Forge å¥—ä»¶ï¼Œéœ€è®¸å¯è¯)      |   HPC å¼€å‘è€…ï¼Œè¶…çº§è®¡ç®—æœºç¯å¢ƒ    |

**å·®å¼‚æ€»ç»“**

- Oracle PA / gprofngï¼šåº”ç”¨å±‚æ€§èƒ½åˆ†æï¼Œå¼ºè°ƒ GUI å’Œè·¨è¯­è¨€æ”¯æŒã€‚
- perfï¼šç³»ç»Ÿçº§é€šç”¨å·¥å…·ï¼Œæ˜¯åº•å±‚æ¡†æ¶ã€‚
- gprofï¼šè€å·¥å…·ï¼ŒåŠŸèƒ½æœ‰é™ï¼Œä¸æ”¯æŒ attachã€‚
- Intel PMU Toolsï¼šåŸºäº perfï¼Œæä¾› Intel CPU å¾®æ¶æ„è§£é‡Šï¼Œæ˜¯ perf çš„å¢å¼ºè§£é‡Šå±‚ã€‚
- Intel Advisorï¼šæ™ºèƒ½ä¼˜åŒ–å»ºè®®å·¥å…·ï¼Œé€‚åˆ HPC å’Œç§‘å­¦è®¡ç®—ã€‚
- Intel VTune Profilerï¼šæ·±åº¦å‰–æå·¥å…·ï¼Œèƒ½æ­ç¤ºç¡¬ä»¶å¾®æ¶æ„ç“¶é¢ˆï¼Œé€‚åˆå•èŠ‚ç‚¹å’Œå¤æ‚åº”ç”¨ã€‚
- Linaro MAPï¼šä¸“ä¸º HPC å¹¶è¡Œåº”ç”¨è®¾è®¡ï¼Œä½å¼€é”€ï¼Œè·¨èŠ‚ç‚¹æ•´ä½“æ€§èƒ½åˆ†æã€‚

**ç»“è®º**

- åº”ç”¨å±‚æ€§èƒ½åˆ†æï¼šOracle PAã€gprofng
- ç³»ç»Ÿ/å†…æ ¸çº§è°ƒä¼˜ï¼šperf
- ç¡¬ä»¶çº§å¾®æ¶æ„åˆ†æï¼šIntel PMU Toolsã€Intel VTune Profiler
- æ™ºèƒ½ä¼˜åŒ–å»ºè®® (HPC)ï¼šIntel Advisor
- å¤§è§„æ¨¡å¹¶è¡Œåº”ç”¨åˆ†æ (HPC)ï¼šLinaro MAP

ğŸ‘‰ å¯ä»¥æŠŠå®ƒä»¬çœ‹ä½œä¸€ä¸ªå±‚æ¬¡ç»“æ„ï¼š

- gprof â†’ gprofng/Oracle PA â†’ perf â†’ Intel PMU Tools/VTune â†’ Advisor/MAP
- é€æ­¥ä»å‡½æ•°çº§åˆ†æ â†’ åº”ç”¨æ€§èƒ½ â†’ ç³»ç»Ÿçº§ â†’ ç¡¬ä»¶çº§ â†’ HPC å¹¶è¡Œæ•´ä½“ä¼˜åŒ–ã€‚

### Performance Analyzer

Oracle Developer Studio æä¾›äº†å¤šç§å·¥å…·ï¼šPerformance Analyzerã€Thread Analyzerã€‚

> [Performance Analyzer å®˜æ–¹æ–‡æ¡£](https://docs.oracle.com/cd/E77782_01/html/E77798/afagg.html#OSSPAgrkam)

#### æ”¶é›†æ•°æ®

ä½¿ç”¨ `collect` å‘½ä»¤æ”¶é›†æ•°æ®
ï¼ˆ[å®˜æ–¹æ–‡æ¡£](https://docs.oracle.com/cd/E77782_01/html/E77798/afadn.html#scrolltoc)ï¼‰ã€‚

```bash
collect collect-options program program-arguments
```

#### å¼€å§‹æ€§èƒ½åˆ†æ

ä½¿ç”¨ `analyzer` å‘½ä»¤è¿›è¡Œæ€§èƒ½åˆ†æ
ï¼ˆ[å®˜æ–¹æ–‡æ¡£](https://docs.oracle.com/cd/E77782_01/html/E77798/afafs.html#scrolltoc)ï¼‰ã€‚

```bash
analyzer [control-options] [experiment | experiment-list]
```

ä¾‹å¦‚ï¼š

```bash
analyzer -c test.1.er test.4.er
```

### Thread Analyzer

> [Thread Analyzer å®˜æ–¹æ–‡æ¡£](https://www.oracle.com/application-development/technologies/developerstudio-features.html#thread-analyzer-tab)

## è®¡æ—¶

### è®¡æ—¶å·¥å…· `time`

```bash
$ /usr/bin/time -p ls
```

Or,

```bash
$ time ls
```

å…¶ä¸­ï¼ˆå‚
è€ƒ[é“¾æ¥](https://ostechnix.com/how-to-find-the-execution-time-of-a-command-or-process-in-linux/)ï¼‰ï¼Œ

```bash
$ type -a time
time is a shell keyword
time is /usr/bin/time
```

### è½¯ä»¶å’Œç¡¬ä»¶å®šæ—¶å™¨

https://weedge.github.io/perf-book-cn/zh/chapters/2-Measuring-Performance/2-5_SW_and_HW_Timers_cn.html
